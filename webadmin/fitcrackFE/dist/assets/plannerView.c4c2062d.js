var h=Object.defineProperty;var i=Object.getOwnPropertySymbols;var l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var n=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,r=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&n(e,s,t[s]);if(i)for(var s of i(t))c.call(t,s)&&n(e,s,t[s]);return e};import{h as d}from"./hostSelector.dae33c91.js";import{H as m}from"./hashlistSelector.3c66396b.js";import{t as u}from"./fc_tile.d4edef3e.js";import{m as p}from"./spyfu-vuex-helpers.esm.87da45d6.js";import{t as f,n as v}from"./index.d232c935.js";import"./index.09a07ba8.js";import"./index.a9d6c6c2.js";import"./selectorMixin.fb99fd96.js";import"./vendor.6aa46313.js";var _=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{staticClass:"max1000"},[s("fc-tile",{staticClass:"ma-2",attrs:{title:"Planner",icon:e.$route.meta.icon}},[s("v-text-field",{attrs:{outlined:"",autofocus:"",required:"",label:"Name"},model:{value:e.name,callback:function(a){e.name=a},expression:"name"}}),s("v-card-title",[s("span",[e._v("Select Hashlist")])]),s("v-container",[s("v-row",[s("v-col",[s("v-btn",{attrs:{large:"",block:"",color:"primary",to:{name:"createHashlist",query:{attach:e.name+" Hashlist"}}}},[s("v-icon",{attrs:{left:""}},[e._v("mdi-book-plus")]),e._v(" Create new input hashlist ")],1)],1)],1),s("v-row",[s("v-col",[s("div",{staticClass:"text-center text-overline text--secondary"},[e._v("or attach an existing one")]),s("HashlistSelector",{model:{value:e.hashListId,callback:function(a){e.hashListId=a},expression:"hashListId"}})],1)],1)],1),s("v-card-title",[s("span",[e._v("How long should the batch take?")])]),s("div",{staticClass:"d-flex"},[s("v-text-field",{staticClass:"mx-2 time-width",attrs:{type:"number",label:"Days",min:"0"},model:{value:e.time.days,callback:function(a){e.$set(e.time,"days",a)},expression:"time.days"}}),s("v-text-field",{staticClass:"mx-2 time-width",attrs:{type:"number",label:"Hours",min:"0",max:"23"},model:{value:e.time.hours,callback:function(a){e.$set(e.time,"hours",a)},expression:"time.hours"}}),s("v-text-field",{staticClass:"mx-2 time-width",attrs:{type:"number",label:"Minutes",min:"0",max:"59"},model:{value:e.time.minutes,callback:function(a){e.$set(e.time,"minutes",a)},expression:"time.minutes"}})],1),s("v-expansion-panels",{staticClass:"margin"},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("span",{staticClass:"d-flex align-center"},[s("v-icon",{attrs:{left:""}},[e._v(" mdi-desktop-classic ")]),s("span",{staticClass:"text-h6"},[e._v("Select Hosts")])],1)]),s("v-expansion-panel-content",[s("v-container",[s("v-subheader",[e._v("Select which hosts to distribute workunits to")]),s("div",{staticClass:"scroller"},[s("host-selector",{attrs:{"select-all":"","auto-refresh":""},model:{value:e.hosts,callback:function(a){e.hosts=a},expression:"hosts"}})],1),s("v-subheader",[s("b",[e._v("("+e._s(e.hosts.length)+" selected)")])])],1)],1)],1)],1),s("v-checkbox",{attrs:{label:"Plan batch according to saved benchmark performance"},model:{value:e.useBenchmarkedCrackSpeed,callback:function(a){e.useBenchmarkedCrackSpeed=a},expression:"useBenchmarkedCrackSpeed"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.useBenchmarkedCrackSpeed,expression:"!useBenchmarkedCrackSpeed"}]},[s("v-text-field",{staticClass:"mx-2 speed-width",attrs:{type:"number",label:"Assumed Cracking Speed (Hs/s)",step:"1000000",min:"0"},model:{value:e.crackSpeed,callback:function(a){e.crackSpeed=a},expression:"crackSpeed"}}),s("v-btn",{staticClass:"d-inline-block",attrs:{color:"primary"},nativeOn:{click:function(a){return a.stopPropagation(),e.getSpeedFromHostBenchmark.apply(null,arguments)}}},[e._v(" Get Speed from Benchmarks ")])],1),s("div",{staticClass:"fill_div"},[s("v-checkbox",{attrs:{label:"Fill rest with brute-force attack"},model:{value:e.fill,callback:function(a){e.fill=a},expression:"fill"}}),s("div",{staticClass:"fill_div"},[s("v-text-field",{staticClass:"mx-2 length-width",attrs:{disabled:!e.fill,type:"number",label:"Min Password Lenght",min:"0"},model:{value:e.password_len_min,callback:function(a){e.password_len_min=a},expression:"password_len_min"}}),s("v-text-field",{staticClass:"mx-2 length-width",attrs:{disabled:!e.fill,type:"number",label:"Max Password Lenght",min:"0"},model:{value:e.password_len_max,callback:function(a){e.password_len_max=a},expression:"password_len_max"}})],1)],1),s("div",{staticClass:"text-center pa-3"},[s("v-btn",{staticClass:"d-inline-block",attrs:{disabled:e.loading,color:"primary"},nativeOn:{click:function(a){return a.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v(" Submit ")])],1)],1)],1)},b=[];const k={name:"PlannerView",components:{"fc-tile":u,"host-selector":d,HashlistSelector:m},data:function(){return{loading:!1,name:"Planned Batch",fill:!1,password_len_min:3,password_len_max:6,time:{days:0,hours:0,minutes:0},hashTypeName:"",hashTypeCode:-1,hashTypes:[],hashList:[],hostsInfo:[],hostsIds:[],hostsBenchmarks:{},benchmarkPowerSum:0,totalSeconds:0,useBenchmarkedCrackSpeed:!0,crackSpeed:1e6,totalCrackSpeed:0,availableKeySpace:0,addr:this.$serverAddr}},computed:r({},p("jobForm",f(["hashListId","hosts"]))),mounted:function(){this.getHashTypes(),this.getHostsInfo()},methods:{submit:async function(){if(this.name===""){this.$error("Job name can not be empty.");return}if(!this.hashListId){this.$error("No Hashlist selected");return}if(this.time.days<0||this.time.hours<0||this.time.minutes<0){this.$error("Time cannot be negative");return}if(this.time.days==0&&this.time.hours==0&&this.time.minutes==0){this.$error("Cannot plan attacks with no time");return}if(this.fill&&this.password_len_min>this.password_len_max){this.$error("Minimal password lenght cannot be higher than maximum.");return}if(this.loading=!0,this.useBenchmarkedCrackSpeed&&!await this.getSpeedFromHostBenchmark()){this.loading=!1;return}for(let e=0;e<this.hosts.length;e++)this.hostsIds.push(this.hosts[e].id);await this.axios.post(this.$serverAddr+"/planner",{days:this.time.days==""?0:this.time.days,hours:this.time.hours==""?0:this.time.hours,minutes:this.time.minutes==""?0:this.time.minutes,cracking_speed:this.crackSpeed,name:this.name,hashList:this.hashListId,hostsIds:this.hostsIds.join(","),fill:this.fill,password_len_min:this.password_len_min,password_len_max:this.password_len_max}).then(e=>{const t=e.data.batch_id,s="/batches/"+t;this.$router.push(s)}),this.loading=!1},getSpeedFromHostBenchmark:async function(){if(this.hostsBenchmarks={},this.hosts.length===0)return this.$error("No hosts selected"),!1;if(!this.hashListId)return this.$error("No Hashlist selected"),!1;const e=await this.axios.get(this.$serverAddr+"/hashlist/"+this.hashListId);this.hashTypeName=e.data.hash_type_name;for(let t=0;t<this.hosts.length;t++){const s=await this.axios.get(this.$serverAddr+"/hosts/"+this.hosts[t].id+"/benchmarks");this.hostsBenchmarks[this.hosts[t].id]=s.data.items}if(console.log(this.hostsBenchmarks),this.hostsBenchmarks.length==0)return this.$error("No benchmarks for one of the selected host found."),!1;this.hashTypeCode=this.hashTypes.find(t=>t.name===this.hashTypeName).code,this.benchmarkPowerSum=0;for(let t=0;t<this.hosts.length;t++){const s=this.hostsBenchmarks[this.hosts[t].id].find(a=>a.attack_mode==0&&a.hash_type==this.hashTypeCode);if(s==null)return this.$error("No benchmarks for one of the selected attack/hash type found."),!1;this.benchmarkPowerSum+=s.power}return this.crackSpeed=this.benchmarkPowerSum,!0},getHashTypes:function(){this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(e=>{this.hashTypes=e.data.hashtypes})},getHostsInfo:function(){this.axios.get(this.$serverAddr+"/hosts").then(e=>{this.hostsInfo=e.data})}}},o={};var x=v(k,_,b,!1,w,"eb51af8a",null,null);function w(e){for(let t in o)this[t]=o[t]}var L=function(){return x.exports}();export{L as default};
