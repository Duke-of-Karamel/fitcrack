var v=Object.defineProperty,p=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var h=(t,s,e)=>s in t?v(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,o=(t,s)=>{for(var e in s||(s={}))_.call(s,e)&&h(t,e,s[e]);if(l)for(var e of l(s))f.call(s,e)&&h(t,e,s[e]);return t},r=(t,s)=>p(t,u(s));import{F as m}from"./fileUploader.8a700325.js";import{f as y}from"./fc_textarea.c62488b7.js";import{H as x}from"./hashTypeAutocomplete.7a13e3d9.js";import{n as g}from"./index.e8a7a5b9.js";var b=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("v-container",[e("v-row",[e("v-col",[e("v-card",[e("v-tabs",{attrs:{grow:"","icons-and-text":""},model:{value:t.modetab,callback:function(a){t.modetab=a},expression:"modetab"}},[e("v-tab",{attrs:{id:"input-manual"}},[t._v(" Manual Input "),e("v-icon",[t._v("mdi-playlist-edit")])],1),e("v-tab",{attrs:{id:"input-file"}},[t._v(" Hashlist file "),e("v-icon",[t._v("mdi-file-upload")])],1),e("v-tab",{attrs:{id:"input-extract",disabled:!!t.existing&&!t.existingTypeCanBeExtracted}},[t._v(" "+t._s(!!t.existing&&!t.existingTypeCanBeExtracted?"Cannot extract this type":"Hash Extractor")+" "),e("v-icon",[t._v("mdi-eye-lock-open")])],1)],1),e("v-container",[e("v-row",[e("v-col",[e("v-fade-transition",{attrs:{mode:"out-in"}},[t.mode!=="extract"?e("div",{staticClass:"d-flex align-center"},[e("hashTypeAutocomplete",{attrs:{required:"",outlined:"",dense:"",label:"Select hash type",disabled:t.mode==="extract"||!!t.existing},on:{input:t.revalidate},model:{value:t.hashType,callback:function(a){t.hashType=a},expression:"hashType"}}),e("div",{staticClass:"text-overline ml-6 mr-2 text--secondary"},[t._v(" Validation ")]),e("v-btn-toggle",{attrs:{mandatory:"","hide-details":"",dense:""},model:{value:t.validationMode,callback:function(a){t.validationMode=a},expression:"validationMode"}},[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("v-btn",t._g({attrs:{value:"fail_invalid"}},i),[t._v(" Strict ")])]}}],null,!1,3690490359)},[e("span",[t._v("Any invalid hash encountered cancels the operation completely.")])]),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("v-btn",t._g({attrs:{value:"skip_invalid"}},i),[t._v(" Skipping ")])]}}],null,!1,3846275694)},[e("span",[t._v("Only valid hashes are saved, the rest is ignored.")])]),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("v-btn",t._g({attrs:{value:"no_validate"}},i),[t._v(" None ")])]}}],null,!1,2409346562)},[e("span",[t._v("No checks are performed before saving the hashes.")])])],1)],1):e("v-alert",{staticClass:"my-0",attrs:{type:"info",dense:"",text:""}},[!!t.existing&&t.existingTypeCanBeExtracted?e("span",[e("strong",[t._v("Note:")]),t._v(" only "+t._s(t.hashType.name)+" will be accepted. ")]):!!t.existing&&!t.existingTypeCanBeExtracted?e("span",[e("strong",[t._v("Note:")]),t._v(" extracting hashes of type "+t._s(t.hashType.name)+" is not supported. ")]):e("span",[t._v("Hash type is determined automatically when extracting from protected files.")])])],1)],1)],1)],1),e("v-divider"),e("v-tabs-items",{model:{value:t.modetab,callback:function(a){t.modetab=a},expression:"modetab"}},[e("v-tab-item",{attrs:{eager:""}},[e("v-container",[e("v-row",[e("v-col",[e("fc-textarea",{ref:"textarea",staticClass:"textarea",attrs:{id:"hashes-input","max-height":"500","can-remove-line":!0,loading:t.processing},on:{input:t.revalidate},model:{value:t.hashListManual,callback:function(a){t.hashListManual=a},expression:"hashListManual"}},[e("div",{staticClass:"hashCheckContainer pl-1 pt-2",attrs:{slot:"after"},slot:"after"},t._l(t.checkedHashesResults,function(a){return e("div",{key:a.id},[a.result==="OK"?e("v-icon",{attrs:{small:"",color:"success"}},[t._v(" check_circle_outlined ")]):e("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({staticClass:"clickable",attrs:{small:"",color:"error"}},n),[t._v(" error_circle_outlined ")])]}}],null,!0)},[e("span",[t._v(t._s(a.result))])]),a.isInCache?e("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({staticClass:"clickable",attrs:{small:"",color:"warning"}},n),[t._v(" error_circle_outlined ")])]}}],null,!0)},[e("span",[t._v("hash already in hashcache")])]):t._e()],1)}),0)])],1)],1)],1)],1),e("v-tab-item",{attrs:{eager:""}},[e("v-container",[e("v-row",[e("v-col",[e("div",{staticClass:"d-flex mx-3 mb-4"},[e("v-checkbox",{attrs:{label:"Treat as a binary hashlist file","hide-details":""},model:{value:t.isBinaryHashlist,callback:function(a){t.isBinaryHashlist=a},expression:"isBinaryHashlist"}})],1),e("file-uploader",{ref:"listUploader",attrs:{"no-upload":"",multiple:!1,label:"Select hashlist file to add"}})],1)],1)],1)],1),e("v-tab-item",{attrs:{eager:""}},[e("v-container",[e("v-row",[e("v-col",[e("file-uploader",{ref:"extractUploader",attrs:{"no-upload":"",multiple:!1,label:"Select protected file to extract"}}),e("v-alert",{attrs:{type:"warning"}},[e("strong",[t._v("Supported formats: ")]),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("span",t._g({},i),[t._v("MS_OFFICE,")])]}}])},[e("span",[t._v("Hash types: 9400, 9500, 9600, 9700, 9800")])]),t._v("\xA0 "),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("span",t._g({},i),[t._v("PDF,")])]}}])},[e("span",[t._v("Hash types: 10400, 10500, 10600, 10700")])]),t._v("\xA0 "),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("span",t._g({},i),[t._v("7Z,")])]}}])},[e("span",[t._v("Hash type: 11600")])]),t._v("\xA0 "),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("span",t._g({},i),[t._v("RAR")])]}}])},[e("span",[t._v("Hash types: 12500, 13000, 23700, 23800")])]),t._v(" and "),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on;return[e("span",t._g({},i),[t._v("ZIP.")])]}}])},[e("span",[t._v("Hash types: 13600, 17200, 17210, 17225, 13001, 23002, 23003")])]),t._v(" Hover each to see codes. ")],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},k=[];const d={withCredentials:!0,headers:{"Content-type":"multipart/form-data"}},C={name:"hashlistCreator",props:{hashlistName:String,hashlistId:Number,autofocus:Boolean},data(){return{processing:!1,modetab:0,hashType:{name:""},hashListManual:"",checkedHashesResults:[],checkingError:!1,existing:null,isBinaryHashlist:!1,validationMode:"fail_invalid",extractableHashTypes:[9400,9500,9600,9700,9800,10400,10500,10600,10700,11600,12500,13e3,23700,23800,13600,17200,17210,17225,13001,23002,23003]}},computed:{mode(){return["manual","upload","extract"][this.modetab]},validNameOrId(){return this.hashlistName.length>0||typeof this.hashlistId=="number"},validManualEntry(){if(this.checkingError&&this.validationMode==="fail_invalid")return!1;const t=this.checkedHashesResults.filter(s=>s.result==="OK").length;return this.validationMode==="skip_invalid"?t>0:this.hashListManual.length>0},valid(){switch(this.mode){case"manual":return this.validNameOrId&&this.hashCode!=null&&this.validManualEntry;case"upload":return this.validNameOrId&&this.hashCode!=null&&this.$refs.listUploader.selectedFiles.length==1;case"extract":return this.validNameOrId&&this.$refs.extractUploader.selectedFiles.length==1;default:return!1}},hashesManual(){return this.hashListManual.split(`
`).map(t=>({hash:t}))},hashCode(){return this.hashType?parseInt(this.hashType.code):null},existingTypeCanBeExtracted(){return this.existing?this.extractableHashTypes.includes(this.hashCode):!1},id(){return this.hashlistId||"new"}},watch:{valid(t){this.$emit("validation",!!t)}},mounted(){this.id!=="new"&&this.loadExistingHahslistInfo()},methods:{async loadExistingHahslistInfo(){const t=await this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(s=>s.data.hashtypes);this.axios.get(`${this.$serverAddr}/hashlist/${this.id}`).then(s=>{const e=s.data;this.hashType=t.find(a=>a.name===e.hash_type_name),this.existing=e})},revalidate(){this.processing=!0,this.checkedHashesErrors=[],this.checkedHashesResults=[],this.axios.post(this.$serverAddr+"/job/verifyHash",{hashtype:this.hashCode,hashes:this.hashListManual}).then(t=>{this.checkingError=t.data.error,this.checkedHashesResults=t.data.items}).finally(()=>{this.processing=!1})},createHashlist(){return new Promise((t,s)=>{this.valid||s("Invalid input");const e=`${this.$serverAddr}/hashlist`;switch(this.mode){case"manual":this.axios.post(`${e}/${this.id}/hashes`,{name:this.hashlistName,hash_type:this.hashCode,hash_list:this.hashesManual,validation_mode:this.validationMode},{withCredentials:!0}).then(t).catch(a=>{s(a)});break;case"upload":this.axios.post(`${e}/${this.id}/file`,this.$refs.listUploader.files,r(o({},d),{params:{name:this.hashlistName,hash_type:this.hashCode,validation_mode:this.validationMode,binary:this.isBinaryHashlist}})).then(t).catch(a=>{s(a)});break;case"extract":this.axios.post(`${e}/${this.id}/extract`,this.$refs.extractUploader.files,r(o({},d),{params:{name:this.hashlistName}})).then(t).catch(a=>{s(a)});break;default:s("Unknown hash input mode, what the what??")}})}},components:{FileUploader:m,fcTextarea:y,hashTypeAutocomplete:x}},c={};var H=g(C,b,k,!1,T,null,null,null);function T(t){for(let s in c)this[s]=c[s]}var I=function(){return H.exports}();export{I as H};
