var ae=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var T=(e,a,t)=>a in e?ae(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,v=(e,a)=>{for(var t in a||(a={}))ne.call(a,t)&&T(e,t,a[t]);if(D)for(var t of D(a))le.call(a,t)&&T(e,t,a[t]);return e},b=(e,a)=>ie(e,re(a));import{f as $}from"./numberFormat.773889d3.js";import{a as oe}from"./iconMaps.853c93a3.js";import{d as g}from"./dictionarySelector.b493f841.js";import{m as p}from"./spyfu-vuex-helpers.esm.87da45d6.js";import{t as h,n as l,a as ce}from"./index.e8a7a5b9.js";import{s as x}from"./selectorMixin.fb99fd96.js";import{j as F,o as j,i as de}from"./vendor.6aa46313.js";import{r as w}from"./rulesSelector.f7945adb.js";import{F as me}from"./fileUploader.8a700325.js";import{f as ue}from"./fc_textarea.c62488b7.js";import{h as ve}from"./hostSelector.78966840.js";import{D as pe}from"./datetime.7b7b8484.js";import{H as he}from"./hashlistCreator.34211ba6.js";import"./vue-infinite-loading.33b09e95.js";import"./index.09a07ba8.js";import"./index.a9d6c6c2.js";import"./hashTypeAutocomplete.7a13e3d9.js";var A={exports:{}},N={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(t,s){return t<<s|t>>>32-s},rotr:function(t,s){return t<<32-s|t>>>s},endian:function(t){if(t.constructor==Number)return a.rotl(t,8)&16711935|a.rotl(t,24)&4278255360;for(var s=0;s<t.length;s++)t[s]=a.endian(t[s]);return t},randomBytes:function(t){for(var s=[];t>0;t--)s.push(Math.floor(Math.random()*256));return s},bytesToWords:function(t){for(var s=[],i=0,r=0;i<t.length;i++,r+=8)s[r>>>5]|=t[i]<<24-r%32;return s},wordsToBytes:function(t){for(var s=[],i=0;i<t.length*32;i+=8)s.push(t[i>>>5]>>>24-i%32&255);return s},bytesToHex:function(t){for(var s=[],i=0;i<t.length;i++)s.push((t[i]>>>4).toString(16)),s.push((t[i]&15).toString(16));return s.join("")},hexToBytes:function(t){for(var s=[],i=0;i<t.length;i+=2)s.push(parseInt(t.substr(i,2),16));return s},bytesToBase64:function(t){for(var s=[],i=0;i<t.length;i+=3)for(var r=t[i]<<16|t[i+1]<<8|t[i+2],n=0;n<4;n++)i*8+n*6<=t.length*8?s.push(e.charAt(r>>>6*(3-n)&63)):s.push("=");return s.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var s=[],i=0,r=0;i<t.length;r=++i%4)r!=0&&s.push((e.indexOf(t.charAt(i-1))&Math.pow(2,-2*r+8)-1)<<r*2|e.indexOf(t.charAt(i))>>>6-r*2);return s}};N.exports=a})();var S={utf8:{stringToBytes:function(e){return S.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(S.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var a=[],t=0;t<e.length;t++)a.push(e.charCodeAt(t)&255);return a},bytesToString:function(e){for(var a=[],t=0;t<e.length;t++)a.push(String.fromCharCode(e[t]));return a.join("")}}},R=S;(function(){var e=N.exports,a=R.utf8,t=R.bin,s=function(r){r.constructor==String?r=a.stringToBytes(r):typeof Buffer!="undefined"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(r)?r=Array.prototype.slice.call(r,0):Array.isArray(r)||(r=r.toString());var n=e.bytesToWords(r),d=r.length*8,f=[],_=1732584193,c=-271733879,m=-1732584194,u=271733878,k=-1009589776;n[d>>5]|=128<<24-d%32,n[(d+64>>>9<<4)+15]=d;for(var y=0;y<n.length;y+=16){for(var Z=_,Q=c,X=m,ee=u,te=k,o=0;o<80;o++){if(o<16)f[o]=n[y+o];else{var M=f[o-3]^f[o-8]^f[o-14]^f[o-16];f[o]=M<<1|M>>>31}var se=(_<<5|_>>>27)+k+(f[o]>>>0)+(o<20?(c&m|~c&u)+1518500249:o<40?(c^m^u)+1859775393:o<60?(c&m|c&u|m&u)-1894007588:(c^m^u)-899497514);k=u,u=m,m=c<<30|c>>>2,c=_,_=se}_+=Z,c+=Q,m+=X,u+=ee,k+=te}return[_,c,m,u,k]},i=function(r,n){var d=e.wordsToBytes(s(r));return n&&n.asBytes?d:n&&n.asString?t.bytesToString(d):e.bytesToHex(d)};i._blocksize=16,i._digestsize=20,A.exports=i})();var fe=A.exports,_e=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select left dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select right dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(s){e.rightDicts=s},expression:"rightDicts"}})],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type left rule")])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type right rule")])])],1),t("v-col",{staticClass:"border px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(s){e.ruleLeft=s},expression:"ruleLeft"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(s){e.ruleRight=s},expression:"ruleRight"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},ke=[];const be={name:"Combinator",components:{"dict-selector":g},computed:p("jobForm",h(["leftDicts","ruleLeft","rightDicts","ruleRight","optimized"])),methods:{checkValid:function(){return this.leftDicts.length>0&&this.rightDicts.length>0}}},L={};var ge=l(be,_e,ke,!1,xe,"232785d5",null,null);function xe(e){for(let a in L)this[a]=L[a]}var ye=function(){return ge.exports}(),$e=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"mask-container"},[t("transition",{attrs:{name:"toolbar-fade"}},[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.focused,expression:"focused"}],staticClass:"charset-toolbar pa-1",attrs:{id:e.id?e.id+"-chips-editor":void 0,elevation:8}},[e._l(e.represenArray,function(s,i){return t("v-chip",{key:i,staticClass:"ma-1",attrs:{color:"primary"},on:{click:function(r){return e.addSymbol(i)}}},[e._v(" "+e._s(s.represent)+" ")])}),e._l(e.customCharsets,function(s,i){return t("v-chip",{key:i,staticClass:"ma-1",attrs:{color:"info"},on:{click:function(r){return e.addSymbol(i+1)}}},[e._v(" "+e._s(s.name)+" ")])})],2)],1),t("div",{staticClass:"mask-input"},[t("v-text-field",{ref:"field",attrs:{id:e.id?e.id+"-mask-input":void 0,label:"Enter mask",filled:"",outlined:"",dense:"","single-line":"",rules:e.maskRules,value:e.value},on:{input:function(s){return e.rawValue=s},focus:function(s){e.focused=!0},blur:function(s){e.focused=!1}}}),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.nonRemovable,expression:"!nonRemovable"}],staticClass:"ml-2 remove-button",attrs:{id:e.id?e.id+"-mask-remove":void 0,icon:""},on:{click:function(s){return e.$emit("remove")}}},[t("v-icon",[e._v("mdi-delete")])],1)],1)],1)},we=[];const Se={name:"MaskSingle",props:{id:{type:String,default:""},value:{type:String,default:""},nonRemovable:{type:Boolean,default:!1},customCharsets:{type:[Array,null],default:null}},data(){return{rawValue:"",focused:!1,maskRules:[e=>{let a=!1;for(let t of e){if(a){if(t==="?"){a=!1;continue}if(this.represenArray[t]===void 0&&(this.customCharsets==null||!this.customCharsets[parseInt(t)-1]))return`Unknown symbol ?${t}`;a=!1;continue}t==="?"?a=!0:a=!1}return!0},e=>/^(\?[ludhHsab1234?]|[^\?])+$/.test(e)||"Invalid mask"],represenArray:{l:{chars:"abcdefghijklmnopqrstuvwxyz",represent:"a-z"},u:{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",represent:"A-Z"},d:{chars:"0123456789",represent:"0-9"},h:{chars:"0123456789abcdef",represent:"0-f"},H:{chars:"0123456789ABCDEF",represent:"0-F"},s:{chars:'\xABspace\xBB!"#$%&()*+,-./:;<=>?@[]^_`{|}~',represent:"special"},a:{chars:"?l?u?d?s",represent:"a-z,A-Z,0-9,special"},b:{chars:"0x00 - 0xff",represent:"ASCII"},"?":{chars:"?",represent:"?"}}}},computed:{},watch:{rawValue(e){this.$emit("input",e)}},methods:{addSymbol:function(e){this.rawValue+="?"+e,this.$refs.field.$el.value=this.rawValue,this.$refs.field.focus()}}},P={};var Ce=l(Se,$e,we,!1,Me,"6883428c",null,null);function Me(e){for(let a in P)this[a]=P[a]}var C=function(){return Ce.exports}(),De=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{value:e.selected,headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"charsetDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.fmt(i.keyspace))+" ")]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}])})},Te=[];const Fe={name:"CharsetSelector",mixins:[x],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"}]}},methods:{fmt:$,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/charset").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(e){e.length>4&&(e=e.slice(1).slice(-4)),this.selected=e,this.$emit("input",e)}}},I={};var je=l(Fe,De,Te,!1,Ae,"28cd8ebc",null,null);function Ae(e){for(let a in I)this[a]=I[a]}var z=function(){return je.exports}(),Ne=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.data-table-select",fn:function(s){var i=s.select,r=s.isSelected;return[t("v-simple-checkbox",{attrs:{value:r,disabled:e.markovSubmode==0},on:{input:i}})]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},Re=[];const Le={name:"MarkovSelector",mixins:[x],props:{value:{type:Array,default:()=>[]},markovSubmode:{type:Number,default:2}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/markovChains").then(e=>{this.items=e.data.items,this.selected=[this.items.find(a=>a.name==="hashcat.hcstat2")],this.loading=!1})}}},H={};var Pe=l(Le,Ne,Re,!1,Ie,null,null,null);function Ie(e){for(let a in H)this[a]=H[a]}var ze=function(){return Pe.exports}(),He=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"maskDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.time",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},Ee=[];const Ve={name:"MaskFileSelector",mixins:[x],props:{value:{type:Object,default:function(){return{}}}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},computed:{selectedId(){return selected[0].id}},watch:{value(e){this.selected=[e]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/masks").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(){this.$emit("input",this.selected[0])}}},E={};var Ye=l(Ve,He,Ee,!1,Be,"f581acce",null,null);function Be(e){for(let a in E)this[a]=E[a]}var Oe=function(){return Ye.exports}(),qe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",{staticClass:"pb-0 mb-2"},[t("span",[e._v("Add masks"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("v-row",{staticClass:"mb-4 px-4"},[t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(s){e.loadMasksDialog=!0}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-file-download ")]),e._v(" Load masks ")],1),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length>1,expression:"masks.length > 1"}],attrs:{color:"error",text:""},on:{click:function(s){e.masks=[""]}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-restart ")]),e._v(" Reset masks ")],1),t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length<50,expression:"masks.length < 50"}],attrs:{id:"add-mask-button",color:"success"},on:{click:function(s){return e.addMask()}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v(" Add mask ")],1)],1),e.masks.length<50?t("div",{staticClass:"mask-editors"},e._l(e.masks,function(s,i){return t("mask-single",{key:i,attrs:{id:"mask-"+i,"non-removable":e.masks.length==1,"custom-charsets":e.charset,value:s},on:{input:function(r){return e.updateMask({index:i,val:r})},remove:function(r){return e.deleteMask(i)}}})}),1):t("v-alert",{attrs:{type:"info"}},[e._v(" Not showing "+e._s(e.masks.length)+" masks to maintain performance and conciseness. ")]),t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select charsets (max. 4)")])]),t("charset-selector",{attrs:{"select-all":""},model:{value:e.charset,callback:function(s){e.charset=s},expression:"charset"}})],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Markov file")])]),t("markov-selector",{attrs:{"markov-submode":e.submode},on:{input:e.checkValid},model:{value:e.markov,callback:function(s){e.markov=s},expression:"markov"}}),t("v-row",[t("v-col",{staticClass:"pl-2",attrs:{cols:"6"}},[t("v-radio-group",{attrs:{column:""},on:{change:e.checkValid},model:{value:e.submode,callback:function(s){e.submode=s},expression:"submode"}},[t("v-radio",{attrs:{label:"Markov disabled",color:"primary",value:0}}),t("v-radio",{attrs:{label:"2D Markov",color:"primary",value:1}}),t("v-radio",{attrs:{label:"3D Markov",color:"primary",value:2}})],1)],1),t("v-col",{staticClass:"pr-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{type:"number",disabled:e.submode===0,label:"Markov threshold",filled:"",dense:"",mask:"########"},on:{input:e.checkValid},model:{value:e.markovThresh,callback:function(s){e.markovThresh=s},expression:"markovThresh"}})],1)],1)],1)],1),t("v-dialog",{attrs:{"max-width":"600"},model:{value:e.loadMasksDialog,callback:function(s){e.loadMasksDialog=s},expression:"loadMasksDialog"}},[t("v-card",[t("v-card-text",[t("maskFile-selector",{on:{input:e.checkValid},model:{value:e.maskFile,callback:function(s){e.maskFile=s},expression:"maskFile"}})],1),t("v-card-actions",[t("v-btn",{attrs:{color:"primary",disabled:!e.maskFile},on:{click:e.loadMasksFromFile}},[e._v(" Load ")])],1)],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},Je=[];const Ue={name:"FcMask",components:{CharsetSelector:z,"mask-single":C,"charset-selector":z,"markov-selector":ze,"maskFile-selector":Oe},data:function(){return{loadMasksDialog:!1,maskFile:null}},computed:v({},p("jobForm",h(["masks","submode","markovThresh","markov","charset","optimized"]))),methods:b(v({},F("jobForm",["addMask","deleteMask","updateMask","mergeMasks"])),{loadMasksFromFile:function(){this.axios.get(this.$serverAddr+"/masks/"+this.maskFile.id).then(e=>{var a=e.data.data.split(`
`);this.mergeMasks(a),this.maskFile=null,this.loadMasksDialog=!1,this.checkValid()})},checkValid:function(){return this.masks[0]!==""}})},V={};var We=l(Ue,qe,Je,!1,Ke,"3460c326",null,null);function Ke(e){for(let a in V)this[a]=V[a]}var Ge=function(){return We.exports}(),Ze=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Fragmentation of dictionaries")])]),t("v-radio-group",{model:{value:e.distributionMode,callback:function(s){e.distributionMode=s},expression:"distributionMode"}},[t("v-radio",{attrs:{label:"On server",value:0}}),t("v-radio",{attrs:{label:"On hosts",value:1}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},Qe=[];const Xe={name:"Dictionary",components:{"dict-selector":g,"rules-selector":w},computed:p("jobForm",h(["leftDicts","rules","optimized","distributionMode"])),methods:{checkValid:function(){return this.leftDicts.length>0}}},Y={};var et=l(Xe,Ze,Qe,!1,tt,"189f17d0",null,null);function tt(e){for(let a in Y)this[a]=Y[a]}var st=function(){return et.exports}(),at=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(s){e.hybridMask=s},expression:"hybridMask"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(s){e.rightDicts=s},expression:"rightDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(s){e.ruleRight=s},expression:"ruleRight"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},it=[];const rt={name:"HybridWordlistMask",components:{"mask-single":C,"dict-selector":g},data:function(){return{attackId:7,attackName:"Hybrid mask+wordlist",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:p("jobForm",h(["ruleLeft","rightDicts","ruleRight","hybridMask","optimized"])),methods:{dictSelected:function(e,a){this.selectedDict2Id=e,this.checkValid()},checkValid:function(){return this.hybridMask!==""&&this.rightDicts.length>0}}},B={};var nt=l(rt,at,it,!1,lt,"d20041c8",null,null);function lt(e){for(let a in B)this[a]=B[a]}var ot=function(){return nt.exports}(),ct=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(s){e.ruleLeft=s},expression:"ruleLeft"}})],1),t("v-col",{attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(s){e.hybridMask=s},expression:"hybridMask"}})],1)],1),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},dt=[];const mt={name:"HybridMaskWordlist",components:{"mask-single":C,"dict-selector":g},data:function(){return{attackId:6,attackName:"Hybrid wordlist+mask",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:p("jobForm",h(["ruleLeft","leftDicts","ruleRight","hybridMask","optimized"])),methods:{checkValid:function(){return this.hybridMask!==""&&this.leftDicts.length>0}}},O={};var ut=l(mt,ct,dt,!1,vt,"7c98baa2",null,null);function vt(e){for(let a in O)this[a]=O[a]}var pt=function(){return ut.exports}(),ht=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,"items-per-page":e.itemsPerPage,"footer-props":e.footerProps,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"pcfgDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.fmt(i.keyspace))+" ")]}},{key:"item.time_added",fn:function(s){var i=s.item;return[e._v(" "+e._s(e.$moment.utc(i.time_added).local().format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},ft=[];const _t={name:"PcfgSelector",mixins:[x],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"},{text:"Added",value:"time_added",align:"end"}]}},watch:{value:function(){this.value&&(this.selected=this.value)}},methods:{fmt:$,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/pcfg").then(e=>{this.items=e.data.items,this.loading=!1})}}},q={};var kt=l(_t,ht,ft,!1,bt,null,null,null);function bt(e){for(let a in q)this[a]=q[a]}var gt=function(){return kt.exports}(),xt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select PCFG grammar"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("pcfg-selector",{model:{value:e.pcfg,callback:function(s){e.pcfg=s},expression:"pcfg"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",required:"",type:"number",suffix:"passwords",max:e.pcfg.length>0?e.pcfg[0].keyspace:0},on:{blur:e.checkValid},model:{value:e.keyspaceLimit,callback:function(s){e.keyspaceLimit=e._n(s)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},yt=[];const $t={name:"Pcfg",components:{"pcfg-selector":gt,"rules-selector":w},data:function(){return{attackId:9,attackName:"pcfg"}},watch:{pcfg(e){e.length>0&&(this.keyspaceLimit=e[0].keyspace)}},computed:p("jobForm",h(["rules","pcfg","keyspaceLimit","optimized"])),methods:{checkValid:function(){this.pcfg.length>0&&this.keyspaceLimit>this.pcfg[0].keyspace&&(this.keyspaceLimit=this.pcfg[0].keyspace)}}},J={};var wt=l($t,xt,yt,!1,St,"04756006",null,null);function St(e){for(let a in J)this[a]=J[a]}var Ct=function(){return wt.exports}(),Mt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(s){e.leftDicts=s},expression:"leftDicts"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Check for password duplicates"},model:{value:e.checkDuplicates,callback:function(s){e.checkDuplicates=s},expression:"checkDuplicates"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Case permutation"},model:{value:e.casePermute,callback:function(s){e.casePermute=s},expression:"casePermute"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.minPasswordLen,callback:function(s){e.minPasswordLen=e._n(s)},expression:"minPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.maxPasswordLen,callback:function(s){e.maxPasswordLen=e._n(s)},expression:"maxPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.minElemInChain,callback:function(s){e.minElemInChain=e._n(s)},expression:"minElemInChain"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.maxElemInChain,callback:function(s){e.maxElemInChain=e._n(s)},expression:"maxElemInChain"}})],1),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.keyspaceLimit,required:"",type:"number",suffix:"passwords",min:"0",max:"keyspace"},on:{input:e.checkValid},model:{value:e.keyspaceLimit,callback:function(s){e.keyspaceLimit=e._n(s)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(s){e.rules=s},expression:"rules"}}),t("v-card-title",[t("span",[e._v("Generate random rules")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.generateRandomRules,required:"",type:"number",suffix:"rules",min:"0"},on:{input:e.checkValid},model:{value:e.generateRandomRules,callback:function(s){e.generateRandomRules=e._n(s)},expression:"generateRandomRules"}}),t("v-divider"),e.$optimizedOnly?e._e():t("v-checkbox",{attrs:{label:"Use optimized computing kernels (limits password length, disable for passwords over 256 chars long)"},model:{value:e.optimized,callback:function(s){e.optimized=s},expression:"optimized"}})],1)},Dt=[];const Tt={name:"Prince",components:{"dict-selector":g,"rules-selector":w},props:["keyspace"],watch:{keyspace(e){e&&(this.keyspaceLimit=e)}},computed:p("jobForm",h(["leftDicts","rules","checkDuplicates","casePermute","minPasswordLen","maxPasswordLen","minElemInChain","maxElemInChain","keyspaceLimit","generateRandomRules","optimized"])),methods:{checkValid:function(){return this.minPasswordLen<=0?(this.$error("Minimal length of passwords must be greater than 0."),!1):this.maxPasswordLen<=0?(this.$error("Maximal length of passwords must be greater than 0."),!1):this.maxPasswordLen>32?(this.$error("Maximal length of passwords must be smaller or equal to 32."),!1):this.minElemInChain<=0?(this.$error("Minimal number of elements per chain must be greater than 0."),!1):this.maxElemInChain<=0?(this.$error("Maximal number of elements per chain must be greater than 0."),!1):this.maxElemInChain>16?(this.$error("Maximal number of elements per chain must be to 16."),!1):this.minPasswordLen>this.maxPasswordLen?(this.$error("Minimal length of passwords must be greater than maximal length of passwords."),!1):this.minElemInChain>this.maxElemInChain?(this.$error("Minimal number of elements per chain must be smaller or equal than maximal number of elements per chain."),!1):this.maxElemInChain>this.maxPasswordLen?(this.$error("Maximal number of elements per chain must be smaller or equal than maximal length of passwords."),!1):this.keyspaceLimit<0?(this.$error("Keyspace limit must be nonnegative value."),!1):this.generateRandomRules<0?(this.$error("Random rules count must be nonnegative value."),!1):this.rules.length>0&&this.generateRandomRules>0?(this.$error("Cannot combine a rule file together with random rules generation."),!1):(this.$hideAlert(),!0)}}},U={};var Ft=l(Tt,Mt,Dt,!1,jt,"35954e64",null,null);function jt(e){for(let a in U)this[a]=U[a]}var At=function(){return Ft.exports}(),Nt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-dialog",{attrs:{width:"800"},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[t("v-btn",e._g({attrs:{disabled:!e.validTemplate,large:"",color:"primary"},on:{click:e.nameMe}},i),[t("v-icon",{attrs:{left:""}},[e._v(" mdi-seed-plus ")]),e._v("Manage Template ")],1)]}}]),model:{value:e.dialog,callback:function(s){e.dialog=s},expression:"dialog"}},[t("v-card",[t("v-card-title",{attrs:{"primary-title":""}},[e._v(" Job template ")]),t("v-card-text",[t("div",{staticClass:"flex mb-3"},[t("v-icon",{attrs:{left:""}},[e._v(" info ")]),t("div",[e._v(" The choices you made in the job configuration will be saved as a template."),t("br"),e._v(" You can pre-fill any new job configuration with templates you saved. "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.name!==""&&e.name===e.inheritedName,expression:"name !== '' && name === inheritedName"}]},[e._v(" Keep the name to update an existing template. ")])])],1),t("v-text-field",{attrs:{id:"templateName",name:"templateName",outlined:"",dense:"","hide-details":"",label:"Template name"},model:{value:e.name,callback:function(s){e.name=s},expression:"name"}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(s){e.dialog=!e.dialog}}},[e._v(" Back to editing ")]),t("v-btn",{attrs:{color:"primary",text:"",disabled:e.name===""},on:{click:e.submit}},[e._v(" "+e._s(e.name!==""&&e.name===e.inheritedName?"Update":"Save")+" template ")])],1)],1)],1)},Rt=[];const Lt={name:"TemplateModal",props:{inheritedName:{type:String,default:""}},data(){return{dialog:!1,name:""}},computed:j("jobForm",["validTemplate"]),methods:{submit(){const e=this.$store.getters["jobForm/makeTemplate"](this.name);console.log(e),this.loading=!0,this.axios.put(this.$serverAddr+"/template",e).then(a=>{this.$emit("templatesUpdated")}).catch(a=>{this.loading=!1}),this.dialog=!1},nameMe(){this.name=this.inheritedName}}},W={};var Pt=l(Lt,Nt,Rt,!1,It,"298f0e70",null,null);function It(e){for(let a in W)this[a]=W[a]}var zt=function(){return Pt.exports}(),Ht=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-data-table",{ref:"table",attrs:{headers:e.headers,items:e.hashlists,search:e.search,options:e.dataTableOptions,"server-items-length":e.totalItems,loading:e.loading,"show-select":"","single-select":"","footer-props":e.footerProps},on:{"update:options":function(s){e.dataTableOptions=s},input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(s){var i=s.item;return[t("router-link",{attrs:{to:{name:"hashlistDetail",params:{id:i.id}}}},[e._v(" "+e._s(i.name)+" ")])]}},{key:"item.added",fn:function(s){var i=s.item;return[e._v(" "+e._s(new Date(i.added).toLocaleString())+" ")]}},{key:"item.progress",fn:function(s){var i=s.item;return[t("div",{staticClass:"d-inline-flex align-center"},[t("span",{staticClass:"mr-1"},[e._v(e._s(i.cracked_hash_count)+" / "+e._s(i.hash_count))]),t("v-progress-circular",{attrs:{value:i.cracked_hash_count/i.hash_count*100,max:100,color:"success",size:"18",rotate:"270"}})],1)]}},{key:"footer.prepend",fn:function(s){return[t("v-text-field",{staticClass:"mx-2 mr-8",attrs:{clearable:"","prepend-icon":"mdi-table-search",label:"Search hashlists","single-line":""},on:{input:e.getData},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}})]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})},Et=[];const Vt={props:{selectAll:{type:Boolean,default:!1},value:{type:Number},autoRefresh:Boolean,hideCompleted:Boolean},data(){return{items:[],search:"",selected:[],footerProps:{itemsPerPageOptions:[3,5,10,20,-1],itemsPerPageText:"Hashlists per page"},interval:null,status:"active",totalItems:0,dataTableOptions:{itemsPerPage:3,sortBy:["added"],sortDesc:[!0]},loading:!0,headers:[{text:"Name",value:"name",align:"start",sortable:!0},{text:"Hash type",value:"hash_type_name",align:"end",sortable:!0},{text:"Progress",value:"progress",align:"end",sortable:!1},{text:"Created",value:"added",align:"end",sortable:!0}],hashlists:[]}},mounted(){this.interval=setInterval(()=>{this.autoRefresh&&this.getData(!0)},2e3),this.getData()},beforeDestroy(){clearInterval(this.interval)},computed:{orderBy(){const e=this.dataTableOptions.sortBy;if(e.length>0)switch(e[0]){case"name":return"name";case"hash_type_name":return"hash_type";case"added":return"added";default:return e[0]}else return null}},methods:{getData(){this.axios.get(this.$serverAddr+"/hashlist",{params:{page:this.dataTableOptions.page,per_page:this.dataTableOptions.itemsPerPage,order_by:this.orderBy,descending:this.dataTableOptions.sortDesc?this.dataTableOptions.sortDesc[0]:!1,name:this.search,hide_fully_cracked_hash_lists:this.hideCompleted}}).then(e=>{this.hashlists=e.data.items,this.totalItems=e.data.total,this.loading=!1,this.value&&(this.selected=this.hashlists.filter(a=>a.id==this.value))})},updateSelected(){this.$emit("input",this.selected.length>0?this.selected[0].id:null)}},watch:{value(e){this.selected=e?this.hashlists.filter(a=>a.id==e):[]},dataTableOptions:{handler(){this.loading=!0,this.getData()},deep:!0}}},K={};var Yt=l(Vt,Ht,Et,!1,Bt,null,null,null);function Bt(e){for(let a in K)this[a]=K[a]}var Ot=function(){return Yt.exports}(),qt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"containerAddJob height100 mx-auto"},[t("v-scale-transition",[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.keyspaceKnown&&e.keyspace||e.estimatedTime,expression:"keyspaceKnown && keyspace || estimatedTime"}],staticClass:"infobar",attrs:{color:"info",dark:"",elevation:"8"}},[t("div",{staticClass:"d-flex"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.keyspace,expression:"keyspace"}],staticClass:"text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-key ")]),t("span",[e._v(" Keyspace ")])],1),t("div",[e._v(e._s(e.numberFormat(e.keyspace)))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.estimatedTime,expression:"estimatedTime"}],staticClass:"ml-4 text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-timelapse ")]),t("span",[e._v(" Est. cracking time ")])],1),t("div",[e._v(e._s(e.estimatedTime))])])])])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loadingProgressCont"},[t("v-progress-circular",{staticClass:"loadingProgress",attrs:{indeterminate:"",color:"primary",size:"65",width:4}})],1),t("v-row",[t("v-col",[e.helpAlreadyDismissed?e._e():t("v-alert",{attrs:{text:"",type:"success",icon:"mdi-help-box",dismissible:""},scopedSlots:e._u([{key:"close",fn:function(s){var i=s.toggle;return[t("v-btn",{attrs:{text:"",small:""},on:{click:function(r){return e.dismissHelp(i)}}},[e._v(" Don't show anymore "),t("v-icon",{attrs:{right:""}},[e._v("mdi-close")])],1)]}}],null,!1,3779908090)},[e._v(" If you need help with creating a job, you can "),t("a",{attrs:{target:"_blank",href:e.$docsLink+"/#/jobs/creating/overview"}},[e._v("read the user manual here")]),e._v(". ")]),e.helpDismissedMessage?t("v-alert",{attrs:{text:"",type:"info",dismissible:""}},[e._v(" Sure. If you need help at any time in the future, use the link in the top right corner. ")]):e._e()],1)],1),t("v-row",[t("v-col",[t("v-text-field",{attrs:{outlined:"",autofocus:"",required:"",label:"Name",hint:"Give this job a descriptive name","persistent-hint":""},model:{value:e.name,callback:function(s){e.name=s},expression:"name"}})],1),t("v-col",[t("v-autocomplete",{attrs:{items:e.templates,"item-text":"name","item-value":"id",value:e.selectedTemplate,"auto-select-first":"",outlined:"",label:"Template",hint:"Prefill the form with a saved template (use empty to quickly reset)","persistent-hint":""},on:{input:e.fetchAndApplyTemplate}})],1)],1),t("div",[t("v-col",[t("v-stepper",{staticClass:"mb-4",attrs:{id:"job-stepper",vertical:"","non-linear":""},model:{value:e.step,callback:function(s){e.step=s},expression:"step"}},[t("v-stepper-step",{attrs:{id:"job-step-1",editable:"",step:"1",color:e.hashListId?"success":"primary",complete:!!e.hashListId,"edit-icon":"mdi-check"}},[e._v(" "+e._s(e.hashlistStepTitle)+" ")]),t("v-stepper-content",{attrs:{step:"1"}},[t("v-container",[t("v-row",[t("v-col",[t("v-btn",{attrs:{large:"",block:"",color:"primary",to:{name:"createHashlist",query:{attach:e.name+" Hashlist"}}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-book-plus")]),e._v(" Create new input hashlist ")],1)],1)],1),t("v-row",[t("v-col",[t("div",{staticClass:"text-center text-overline text--secondary"},[e._v("or attach an existing one")]),t("HashlistSelector",{attrs:{"hide-completed":""},model:{value:e.hashListId,callback:function(s){e.hashListId=s},expression:"hashListId"}})],1)],1),t("v-row",{staticClass:"mb-2"},[t("v-spacer"),t("v-btn",{attrs:{color:"primary",disabled:!e.hashListId},on:{click:function(s){e.step=2}}},[e._v(" "+e._s(e.hashListId?"Next":"Select a hashlist above")+" ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-2",editable:"",step:"2"}},[e._v(" Attack settings ")]),t("v-stepper-content",{attrs:{step:"2"}},[t("v-container",[t("v-card-title",[e._v("Attack mode")]),t("v-item-group",{staticClass:"d-flex flex-wrap justify-space-between",model:{value:e.attackSettingsTab,callback:function(s){e.attackSettingsTab=s},expression:"attackSettingsTab"}},e._l(e.attacks,function(s,i){return t("v-item",{key:i,attrs:{value:s.handler},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.active,d=r.toggle;return[t("v-btn",{staticClass:"mode-btn",attrs:{id:"attack-mode-"+s.handler,text:"",small:"",color:n?"primary":""},on:{click:d}},[t("div",{staticClass:"my-3"},[t("v-icon",{staticClass:"mb-2"},[e._v(" "+e._s(e.attackIcon(s.handler))+" ")]),t("div",[e._v(e._s(s.name))])],1)])]}}],null,!0)})}),1),t(e.attackSettingsTab,{tag:"v-component",attrs:{id:e.attackSettingsTab,keyspace:e.keyspace}}),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(s){e.step=3}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-3",editable:"",step:"3"}},[e._v(" Host assignment ")]),t("v-stepper-content",{attrs:{step:"3"}},[t("v-container",[t("v-subheader",[e._v("Select which hosts to distribute workunits to")]),t("div",{staticClass:"scroller"},[t("host-selector",{attrs:{"select-all":"","auto-refresh":""},model:{value:e.hosts,callback:function(s){e.hosts=s},expression:"hosts"}})],1),t("v-subheader",[t("b",[e._v("("+e._s(e.hosts.length)+" selected)")])]),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(s){e.step=4}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{id:"job-step-4",editable:"",step:"4"}},[e._v(" Additional settings ")]),t("v-stepper-content",{attrs:{step:"4"}},[t("v-container",[t("v-row",[t("v-textarea",{attrs:{id:"comment-input",label:"Comment",outlined:"","auto-grow":"",rows:1},model:{value:e.comment,callback:function(s){e.comment=s},expression:"comment"}})],1),t("v-row",[t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned start")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.startNow,"single-line":"",label:""},model:{value:e.startDate,callback:function(s){e.startDate=s},expression:"startDate"}}),t("v-checkbox",{attrs:{label:"Immediately"},model:{value:e.startNow,callback:function(s){e.startNow=s},expression:"startNow"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v(" Desired time per workunit ")]),t("v-text-field",{attrs:{outlined:"","hide-details":"","single-line":"",label:"Time for job",required:"",type:"number",suffix:"seconds",min:60},model:{value:e.timeForJob,callback:function(s){e.timeForJob=s},expression:"timeForJob"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned end")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.endNever,"single-line":""},model:{value:e.endDate,callback:function(s){e.endDate=s},expression:"endDate"}}),t("v-checkbox",{attrs:{label:"No time limit"},model:{value:e.endNever,callback:function(s){e.endNever=s},expression:"endNever"}})],1)],1)],1)],1)],1),e.hosts.length==0?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" This job has no hosts assigned to it and won't be able to run until edited! ")])],1):e._e(),e.timeForJob<180?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" Setting extremely low time per workunit leads to high overhead. The cracking may take much longer than estimated. Consider choosing a higher value. ")])],1):e._e(),t("v-row",{staticClass:"mb-5 mt-2",attrs:{justify:"center"}},[t("template-modal",{attrs:{"inherited-name":e.selectedTemplateName},on:{templatesUpdated:e.fetchTemplates}}),t("v-btn",{staticClass:"ml-2",attrs:{large:"",color:"primary"},on:{click:e.submit}},[t("v-icon",{attrs:{left:""}},[e._v(" "+e._s(e.canCreateJob()?"mdi-check":"mdi-content-save")+" ")]),e._v(" "+e._s(e.canCreateJob()?"Create":"Save for later")+" ")],1)],1)],1)],1)],1)},Jt=[];const Ut={name:"AddJob",components:{FileUploader:me,combinator:ye,maskattack:Ge,dictionary:st,hybridMaskWordlist:ot,hybridWordlistMask:pt,pcfgAttack:Ct,princeAttack:At,"fc-textarea":ue,"host-selector":ve,"template-modal":zt,dtPicker:pe,HashlistCreator:he,HashlistSelector:Ot},data:function(){return{loading:!1,helpDismissedMessage:!1,showEstimatedTime:!1,estimatedTime:null,keyspace:null,selectedTemplateName:"",attacks:ce,templates:[{name:"Empty",id:0}]}},computed:b(v(v(v({},de("jobForm",["selectedTemplate"])),p("jobForm",h(["step","attackSettingsTab","hashListId","name","startDate","endDate","template","comment","hosts","startNow","endNever","timeForJob"]))),j("jobForm",["jobSettings","valid","validAttackSpecificSettings","keyspaceKnown"])),{templateItems(){return this.templates.map((e,a)=>({text:e.template,value:a}))},dev(){return localStorage.getItem("testmode")=="true"},helpAlreadyDismissed(){return localStorage.getItem("dismissedHelp")=="true"},hashlistStepTitle(){return this.hashListId?"Hashlist attached":"Hashlist selection"}}),watch:{jobSettings(e){if(this.estimatedTime=null,this.keyspace=null,e.attack_settings!=!1&&this.validAttackSpecificSettings){var a=[];for(let t=0;t<this.hosts.length;t++)a.push(this.hosts[t].id);if(!this.hashListId)return;this.axios.post(this.$serverAddr+"/job/crackingTime",{hash_list_id:this.hashListId,boinc_host_ids:a.join(","),attack_settings:JSON.stringify(e.attack_settings),workunit_time:this.timeForJob}).then(t=>{t.data&&(this.estimatedTime=t.data.display_time,this.keyspace=t.data.keyspace)})}}},mounted:function(){this.loadSettings(),this.startDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.endDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.fetchTemplates(),this.name===""&&this.generateJobName()},methods:b(v({},F("jobForm",["applyTemplate"])),{numberFormat:$,attackIcon:oe,async loadSettings(){if(!this.timeForJob){const e=await this.axios.get(this.$serverAddr+"/settings").then(a=>a.data);this.timeForJob=e.default_seconds_per_workunit}},dismissHelp(e){localStorage.setItem("dismissedHelp",!0),e(),this.helpDismissedMessage=!0},fetchTemplates(){this.axios.get(this.$serverAddr+"/template").then(e=>{e.data&&e.data.items&&(this.templates=[{name:"Empty",id:0},...e.data.items])}).catch(console.error)},fetchAndApplyTemplate(e){if(e==0){this.applyTemplate(),this.selectedTemplateName="",this.$store.commit("jobForm/selectedTemplateMut",0),this.loadSettings();return}this.axios.get(this.$serverAddr+`/template/${e}`).then(a=>{if(a.data&&a.data.template){const t=JSON.parse(a.data.template);this.applyTemplate(t),this.selectedTemplateName=t.template,this.$store.commit("jobForm/selectedTemplateMut",e)}}).catch(console.error)},submit(){if(this.name===""){this.$error("Job name can not be empty.");return}if(!this.attackSettingsTab){this.$error("No attack selected."),this.step=2;return}if(this.jobSettings.attack_settings===!1){this.$error("Error in attack settings."),this.step=2;return}if(this.keyspace>18446744e12){this.$error("Job keyspace is higher than maximal allowed value 2^64."),this.step=2;return}if(this.timeForJob<10){this.$error("Time per workunit must be higher or equal to 10 seconds."),this.step=4;return}if(!this.valid){this.$error("Error in attack settings."),this.step=2;return}this.loading=!0;const e=this.startNow?this.jobSettings.time_start:this.$moment(this.jobSettings.time_start).utc().toISOString(!0).slice(0,16),a=this.endNever?this.jobSettings.time_end:this.$moment(this.jobSettings.time_end).utc().toISOString(!0).slice(0,16),t=b(v({},this.jobSettings),{time_start:e,time_end:a});this.axios.post(this.$serverAddr+"/job",t).then(s=>{this.$router.push({name:"jobDetail",params:{id:s.data.job_id}}),this.applyTemplate()}).catch(s=>{this.loading=!1})},getRandomHash(){const e=Math.random().toString(36).substring(2,6);this.hashList+=`${fe(e)}
`,this.hashType={code:"100",name:"SHA1"},this.comment+=`(${e}) `,this.validateHashes()},generateJobName(){this.name=this.$store.state.project+" Job \u2013 "+this.$moment().format("DD.MM.YYYY HH:mm")},canCreateJob(){return this.hosts.some(e=>e.last_active.online)}})},G={};var Wt=l(Ut,qt,Jt,!1,Kt,"5075e6fb",null,null);function Kt(e){for(let a in G)this[a]=G[a]}var ps=function(){return Wt.exports}();export{ps as default};
